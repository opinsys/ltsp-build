#!/bin/sh

set -eu

echo ">>>>> Install pxeboot files for ltsp clients"

# apt-get -y install syslinux tftpd-hpa

cp /usr/lib/syslinux/chain.c32  /var/lib/tftpboot/chain.c32
cp /usr/lib/syslinux/menu.c32   /var/lib/tftpboot/menu.c32
cp /usr/lib/syslinux/pxelinux.0 /var/lib/tftpboot/pxelinux.0

mkdir -p /var/lib/tftpboot/pxelinux.cfg

cat <<-'EOF' > /var/lib/tftpboot/pxelinux.cfg/default
	DEFAULT ltsp
	LABEL ltsp
	KERNEL ltsp/i386/vmlinuz
	APPEND ro initrd=ltsp/i386/initrd.img root=/dev/nbd0 init=/sbin/init-ltsp quiet splash plymouth:force-splash vt.handoff=7
	EOF
